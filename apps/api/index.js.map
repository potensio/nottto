{"version":3,"sources":["src/index.ts","src/routes/auth.ts","../../packages/shared/src/schemas/index.ts","src/middleware/auth.ts","src/services/auth.ts","../../packages/shared/src/db/index.ts","../../packages/shared/src/db/schema.ts","src/db.ts","src/utils/auth.ts","src/utils/slug.ts","src/routes/workspaces.ts","src/services/workspaces.ts","src/services/projects.ts","src/routes/projects.ts","src/services/annotations.ts","src/routes/annotations.ts","src/routes/upload.ts","src/services/upload.ts","src/middleware/error-handler.ts"],"sourcesContent":["import { Hono } from \"hono\";\nimport { cors } from \"hono/cors\";\nimport { logger } from \"hono/logger\";\nimport { authRoutes } from \"./routes/auth\";\nimport { workspaceRoutes } from \"./routes/workspaces\";\nimport { projectRoutes } from \"./routes/projects\";\nimport { annotationRoutes } from \"./routes/annotations\";\nimport { uploadRoutes } from \"./routes/upload\";\nimport { errorHandler } from \"./middleware/error-handler\";\n\nconst app = new Hono();\n\n// Global middleware\napp.use(\"*\", logger());\napp.use(\n  \"*\",\n  cors({\n    origin: [\"http://localhost:3000\", \"https://app.nottto.com\"],\n    credentials: true,\n  })\n);\n\n// Error handler\napp.onError(errorHandler);\n\n// Health check\napp.get(\"/\", (c) => c.json({ status: \"ok\", service: \"nottto-api\" }));\n\n// Routes\napp.route(\"/auth\", authRoutes);\napp.route(\"/workspaces\", workspaceRoutes);\napp.route(\"/projects\", projectRoutes);\napp.route(\"/annotations\", annotationRoutes);\napp.route(\"/upload\", uploadRoutes);\n\n// 404 handler\napp.notFound((c) =>\n  c.json({ error: { code: \"NOT_FOUND\", message: \"Route not found\" } }, 404)\n);\n\nexport default app;\n","import { Hono } from \"hono\";\nimport { zValidator } from \"@hono/zod-validator\";\nimport { registerSchema, loginSchema, refreshSchema } from \"@nottto/shared\";\nimport { authMiddleware } from \"../middleware/auth\";\nimport * as authService from \"../services/auth\";\n\nexport const authRoutes = new Hono();\n\n// POST /auth/register - Create account\nauthRoutes.post(\"/register\", zValidator(\"json\", registerSchema), async (c) => {\n  const { email, password, name } = c.req.valid(\"json\");\n  const result = await authService.register(email, password, name);\n  return c.json(result, 201);\n});\n\n// POST /auth/login - Login\nauthRoutes.post(\"/login\", zValidator(\"json\", loginSchema), async (c) => {\n  const { email, password } = c.req.valid(\"json\");\n  const result = await authService.login(email, password);\n  return c.json(result);\n});\n\n// POST /auth/refresh - Refresh token\nauthRoutes.post(\"/refresh\", zValidator(\"json\", refreshSchema), async (c) => {\n  const { refreshToken } = c.req.valid(\"json\");\n  const result = await authService.refresh(refreshToken);\n  return c.json(result);\n});\n\n// GET /auth/me - Get current user (protected)\nauthRoutes.get(\"/me\", authMiddleware, async (c) => {\n  const userId = c.get(\"userId\");\n  const user = await authService.getUser(userId);\n  return c.json({ user });\n});\n","import { z } from \"zod\";\n\n// Auth schemas\nexport const registerSchema = z.object({\n  email: z.string().email(\"Invalid email format\"),\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  name: z.string().min(1).max(255).optional(),\n});\n\nexport const loginSchema = z.object({\n  email: z.string().email(\"Invalid email format\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\nexport const refreshSchema = z.object({\n  refreshToken: z.string().min(1, \"Refresh token is required\"),\n});\n\n// Workspace schemas\nexport const createWorkspaceSchema = z.object({\n  name: z.string().min(1, \"Name is required\").max(255),\n});\n\nexport const updateWorkspaceSchema = z.object({\n  name: z.string().min(1).max(255).optional(),\n  slug: z\n    .string()\n    .min(1)\n    .max(255)\n    .regex(/^[a-z0-9-]+$/, \"Slug must be lowercase alphanumeric with hyphens\")\n    .optional(),\n});\n\n// Project schemas\nexport const createProjectSchema = z.object({\n  name: z.string().min(1, \"Name is required\").max(255),\n  description: z.string().max(1000).optional(),\n});\n\nexport const updateProjectSchema = z.object({\n  name: z.string().min(1).max(255).optional(),\n  slug: z\n    .string()\n    .min(1)\n    .max(255)\n    .regex(/^[a-z0-9-]+$/, \"Slug must be lowercase alphanumeric with hyphens\")\n    .optional(),\n  description: z.string().max(1000).optional(),\n});\n\n// Annotation schemas\nexport const annotationTypeSchema = z.enum([\"bug\", \"improvement\", \"question\"]);\nexport const annotationPrioritySchema = z.enum([\n  \"urgent\",\n  \"high\",\n  \"medium\",\n  \"low\",\n]);\n\nexport const createAnnotationSchema = z.object({\n  title: z.string().min(1, \"Title is required\").max(255),\n  description: z.string().max(5000).optional(),\n  type: annotationTypeSchema.optional(),\n  priority: annotationPrioritySchema.optional(),\n  pageUrl: z.string().url(\"Invalid URL\").optional(),\n  pageTitle: z.string().max(255).optional(),\n  screenshotOriginal: z.string().url(\"Invalid URL\").optional(),\n  screenshotAnnotated: z.string().url(\"Invalid URL\").optional(),\n  canvasData: z.any().optional(),\n});\n\nexport const updateAnnotationSchema = z.object({\n  title: z.string().min(1).max(255).optional(),\n  description: z.string().max(5000).optional(),\n  type: annotationTypeSchema.optional().nullable(),\n  priority: annotationPrioritySchema.optional().nullable(),\n  pageUrl: z.string().url(\"Invalid URL\").optional().nullable(),\n  pageTitle: z.string().max(255).optional().nullable(),\n  screenshotOriginal: z.string().url(\"Invalid URL\").optional().nullable(),\n  screenshotAnnotated: z.string().url(\"Invalid URL\").optional().nullable(),\n  canvasData: z.any().optional().nullable(),\n});\n\n// Type exports from schemas\nexport type RegisterInput = z.infer<typeof registerSchema>;\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type RefreshInput = z.infer<typeof refreshSchema>;\nexport type CreateWorkspaceInput = z.infer<typeof createWorkspaceSchema>;\nexport type UpdateWorkspaceInput = z.infer<typeof updateWorkspaceSchema>;\nexport type CreateProjectInput = z.infer<typeof createProjectSchema>;\nexport type UpdateProjectInput = z.infer<typeof updateProjectSchema>;\nexport type CreateAnnotationInput = z.infer<typeof createAnnotationSchema>;\nexport type UpdateAnnotationInput = z.infer<typeof updateAnnotationSchema>;\n","import type { Context, Next } from \"hono\";\nimport { HTTPException } from \"hono/http-exception\";\nimport { jwtVerify } from \"jose\";\n\nexport interface AuthContext {\n  userId: string;\n  userEmail: string;\n}\n\ndeclare module \"hono\" {\n  interface ContextVariableMap {\n    userId: string;\n    userEmail: string;\n  }\n}\n\nexport async function authMiddleware(\n  c: Context,\n  next: Next\n): Promise<void | Response> {\n  const authHeader = c.req.header(\"Authorization\");\n\n  if (!authHeader?.startsWith(\"Bearer \")) {\n    throw new HTTPException(401, {\n      message: \"Missing or invalid authorization header\",\n    });\n  }\n\n  const token = authHeader.slice(7);\n\n  try {\n    const secret = new TextEncoder().encode(process.env.JWT_SECRET);\n    const { payload } = await jwtVerify(token, secret);\n\n    if (!payload.sub || !payload.email) {\n      throw new HTTPException(401, { message: \"Invalid token payload\" });\n    }\n\n    c.set(\"userId\", payload.sub as string);\n    c.set(\"userEmail\", payload.email as string);\n\n    await next();\n  } catch (error) {\n    if (error instanceof HTTPException) {\n      throw error;\n    }\n    throw new HTTPException(401, { message: \"Invalid or expired token\" });\n  }\n}\n","import { eq } from \"drizzle-orm\";\nimport { HTTPException } from \"hono/http-exception\";\nimport { db } from \"../db\";\nimport {\n  users,\n  workspaces,\n  workspaceMembers,\n  projects,\n} from \"@nottto/shared/db\";\nimport {\n  hashPassword,\n  verifyPassword,\n  generateTokens,\n  verifyRefreshToken,\n  generateAccessToken,\n} from \"../utils/auth\";\nimport { generateSlug } from \"../utils/slug\";\nimport type { User, AuthResponse, RefreshResponse } from \"@nottto/shared\";\n\nexport async function register(\n  email: string,\n  password: string,\n  name?: string\n): Promise<AuthResponse> {\n  // Check if user already exists\n  const existingUser = await db\n    .select()\n    .from(users)\n    .where(eq(users.email, email))\n    .limit(1);\n\n  if (existingUser.length > 0) {\n    throw new HTTPException(409, { message: \"Email already registered\" });\n  }\n\n  // Hash password\n  const passwordHash = await hashPassword(password);\n\n  // Create user\n  const [newUser] = await db\n    .insert(users)\n    .values({\n      email,\n      passwordHash,\n      name: name || null,\n    })\n    .returning();\n\n  // Create default workspace\n  const workspaceSlug = generateSlug(\"My Workspace\");\n  const [newWorkspace] = await db\n    .insert(workspaces)\n    .values({\n      name: \"My Workspace\",\n      slug: workspaceSlug,\n      ownerId: newUser.id,\n    })\n    .returning();\n\n  // Add user as workspace owner member\n  await db.insert(workspaceMembers).values({\n    workspaceId: newWorkspace.id,\n    userId: newUser.id,\n    role: \"owner\",\n  });\n\n  // Create default project\n  const projectSlug = generateSlug(\"Default Project\");\n  await db.insert(projects).values({\n    workspaceId: newWorkspace.id,\n    name: \"Default Project\",\n    slug: projectSlug,\n    description: \"Your first project\",\n  });\n\n  // Generate tokens\n  const tokens = await generateTokens({\n    sub: newUser.id,\n    email: newUser.email,\n  });\n\n  const user: User = {\n    id: newUser.id,\n    email: newUser.email,\n    name: newUser.name,\n    createdAt: newUser.createdAt,\n    updatedAt: newUser.updatedAt,\n  };\n\n  return { user, tokens };\n}\n\nexport async function login(\n  email: string,\n  password: string\n): Promise<AuthResponse> {\n  // Find user\n  const [user] = await db\n    .select()\n    .from(users)\n    .where(eq(users.email, email))\n    .limit(1);\n\n  if (!user) {\n    throw new HTTPException(401, { message: \"Invalid email or password\" });\n  }\n\n  // Verify password\n  const isValid = await verifyPassword(password, user.passwordHash);\n  if (!isValid) {\n    throw new HTTPException(401, { message: \"Invalid email or password\" });\n  }\n\n  // Generate tokens\n  const tokens = await generateTokens({\n    sub: user.id,\n    email: user.email,\n  });\n\n  const userResponse: User = {\n    id: user.id,\n    email: user.email,\n    name: user.name,\n    createdAt: user.createdAt,\n    updatedAt: user.updatedAt,\n  };\n\n  return { user: userResponse, tokens };\n}\n\nexport async function refresh(refreshToken: string): Promise<RefreshResponse> {\n  try {\n    const payload = await verifyRefreshToken(refreshToken);\n\n    // Verify user still exists\n    const [user] = await db\n      .select()\n      .from(users)\n      .where(eq(users.id, payload.sub))\n      .limit(1);\n\n    if (!user) {\n      throw new HTTPException(401, { message: \"User not found\" });\n    }\n\n    // Generate new access token\n    const accessToken = await generateAccessToken({\n      sub: user.id,\n      email: user.email,\n    });\n\n    return { accessToken };\n  } catch (error) {\n    if (error instanceof HTTPException) {\n      throw error;\n    }\n    throw new HTTPException(401, {\n      message: \"Invalid or expired refresh token\",\n    });\n  }\n}\n\nexport async function getUser(userId: string): Promise<User> {\n  const [user] = await db\n    .select()\n    .from(users)\n    .where(eq(users.id, userId))\n    .limit(1);\n\n  if (!user) {\n    throw new HTTPException(404, { message: \"User not found\" });\n  }\n\n  return {\n    id: user.id,\n    email: user.email,\n    name: user.name,\n    createdAt: user.createdAt,\n    updatedAt: user.updatedAt,\n  };\n}\n","import { neon } from \"@neondatabase/serverless\";\nimport { drizzle } from \"drizzle-orm/neon-http\";\nimport * as schema from \"./schema\";\n\nexport function createDb(databaseUrl: string) {\n  const sql = neon(databaseUrl);\n  return drizzle(sql, { schema });\n}\n\nexport type Database = ReturnType<typeof createDb>;\n\nexport * from \"./schema\";\n","import {\n  pgTable,\n  uuid,\n  varchar,\n  text,\n  timestamp,\n  jsonb,\n  unique,\n} from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\n\n// Users table\nexport const users = pgTable(\"users\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  email: varchar(\"email\", { length: 255 }).unique().notNull(),\n  passwordHash: varchar(\"password_hash\", { length: 255 }).notNull(),\n  name: varchar(\"name\", { length: 255 }),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Workspaces table\nexport const workspaces = pgTable(\"workspaces\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  name: varchar(\"name\", { length: 255 }).notNull(),\n  slug: varchar(\"slug\", { length: 255 }).unique().notNull(),\n  ownerId: uuid(\"owner_id\")\n    .references(() => users.id, { onDelete: \"cascade\" })\n    .notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Workspace members table (for future multi-user support)\nexport const workspaceMembers = pgTable(\n  \"workspace_members\",\n  {\n    id: uuid(\"id\").primaryKey().defaultRandom(),\n    workspaceId: uuid(\"workspace_id\")\n      .references(() => workspaces.id, { onDelete: \"cascade\" })\n      .notNull(),\n    userId: uuid(\"user_id\")\n      .references(() => users.id, { onDelete: \"cascade\" })\n      .notNull(),\n    role: varchar(\"role\", { length: 50 }).default(\"member\").notNull(),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  },\n  (table) => [\n    unique(\"workspace_user_unique\").on(table.workspaceId, table.userId),\n  ]\n);\n\n// Projects table\nexport const projects = pgTable(\n  \"projects\",\n  {\n    id: uuid(\"id\").primaryKey().defaultRandom(),\n    workspaceId: uuid(\"workspace_id\")\n      .references(() => workspaces.id, { onDelete: \"cascade\" })\n      .notNull(),\n    name: varchar(\"name\", { length: 255 }).notNull(),\n    slug: varchar(\"slug\", { length: 255 }).notNull(),\n    description: text(\"description\"),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n  },\n  (table) => [\n    unique(\"workspace_project_slug_unique\").on(table.workspaceId, table.slug),\n  ]\n);\n\n// Annotations table\nexport const annotations = pgTable(\"annotations\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  projectId: uuid(\"project_id\")\n    .references(() => projects.id, { onDelete: \"cascade\" })\n    .notNull(),\n  userId: uuid(\"user_id\").references(() => users.id, { onDelete: \"set null\" }),\n  title: varchar(\"title\", { length: 255 }).notNull(),\n  description: text(\"description\"),\n  type: varchar(\"type\", { length: 50 }),\n  priority: varchar(\"priority\", { length: 50 }),\n  pageUrl: text(\"page_url\"),\n  pageTitle: varchar(\"page_title\", { length: 255 }),\n  screenshotOriginal: text(\"screenshot_original\"),\n  screenshotAnnotated: text(\"screenshot_annotated\"),\n  canvasData: jsonb(\"canvas_data\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  workspaces: many(workspaces),\n  workspaceMembers: many(workspaceMembers),\n  annotations: many(annotations),\n}));\n\nexport const workspacesRelations = relations(workspaces, ({ one, many }) => ({\n  owner: one(users, {\n    fields: [workspaces.ownerId],\n    references: [users.id],\n  }),\n  members: many(workspaceMembers),\n  projects: many(projects),\n}));\n\nexport const workspaceMembersRelations = relations(\n  workspaceMembers,\n  ({ one }) => ({\n    workspace: one(workspaces, {\n      fields: [workspaceMembers.workspaceId],\n      references: [workspaces.id],\n    }),\n    user: one(users, {\n      fields: [workspaceMembers.userId],\n      references: [users.id],\n    }),\n  })\n);\n\nexport const projectsRelations = relations(projects, ({ one, many }) => ({\n  workspace: one(workspaces, {\n    fields: [projects.workspaceId],\n    references: [workspaces.id],\n  }),\n  annotations: many(annotations),\n}));\n\nexport const annotationsRelations = relations(annotations, ({ one }) => ({\n  project: one(projects, {\n    fields: [annotations.projectId],\n    references: [projects.id],\n  }),\n  user: one(users, {\n    fields: [annotations.userId],\n    references: [users.id],\n  }),\n}));\n\n// Type exports\nexport type UserRecord = typeof users.$inferSelect;\nexport type NewUserRecord = typeof users.$inferInsert;\nexport type WorkspaceRecord = typeof workspaces.$inferSelect;\nexport type NewWorkspaceRecord = typeof workspaces.$inferInsert;\nexport type WorkspaceMemberRecord = typeof workspaceMembers.$inferSelect;\nexport type NewWorkspaceMemberRecord = typeof workspaceMembers.$inferInsert;\nexport type ProjectRecord = typeof projects.$inferSelect;\nexport type NewProjectRecord = typeof projects.$inferInsert;\nexport type AnnotationRecord = typeof annotations.$inferSelect;\nexport type NewAnnotationRecord = typeof annotations.$inferInsert;\n","import { createDb, type Database } from \"@nottto/shared/db\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL environment variable is required\");\n}\n\nexport const db: Database = createDb(process.env.DATABASE_URL);\n","import bcrypt from \"bcryptjs\";\nimport { SignJWT, jwtVerify } from \"jose\";\n\nconst SALT_ROUNDS = 10;\nconst ACCESS_TOKEN_EXPIRY = \"15m\";\nconst REFRESH_TOKEN_EXPIRY = \"7d\";\n\n// Password hashing\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, SALT_ROUNDS);\n}\n\nexport async function verifyPassword(\n  password: string,\n  hash: string\n): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n\n// JWT token generation\ninterface TokenPayload {\n  sub: string;\n  email: string;\n}\n\nexport async function generateAccessToken(\n  payload: TokenPayload\n): Promise<string> {\n  const secret = new TextEncoder().encode(process.env.JWT_SECRET);\n\n  return new SignJWT({ ...payload })\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(ACCESS_TOKEN_EXPIRY)\n    .sign(secret);\n}\n\nexport async function generateRefreshToken(\n  payload: TokenPayload\n): Promise<string> {\n  const secret = new TextEncoder().encode(process.env.JWT_REFRESH_SECRET);\n\n  return new SignJWT({ ...payload })\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(REFRESH_TOKEN_EXPIRY)\n    .sign(secret);\n}\n\nexport async function generateTokens(\n  payload: TokenPayload\n): Promise<{ accessToken: string; refreshToken: string }> {\n  const [accessToken, refreshToken] = await Promise.all([\n    generateAccessToken(payload),\n    generateRefreshToken(payload),\n  ]);\n\n  return { accessToken, refreshToken };\n}\n\nexport async function verifyAccessToken(token: string): Promise<TokenPayload> {\n  const secret = new TextEncoder().encode(process.env.JWT_SECRET);\n  const { payload } = await jwtVerify(token, secret);\n\n  return {\n    sub: payload.sub as string,\n    email: payload.email as string,\n  };\n}\n\nexport async function verifyRefreshToken(token: string): Promise<TokenPayload> {\n  const secret = new TextEncoder().encode(process.env.JWT_REFRESH_SECRET);\n  const { payload } = await jwtVerify(token, secret);\n\n  return {\n    sub: payload.sub as string,\n    email: payload.email as string,\n  };\n}\n","/**\n * Generate a URL-safe slug from a string\n */\nexport function generateSlug(name: string): string {\n  return name\n    .toLowerCase()\n    .trim()\n    .replace(/[^\\w\\s-]/g, \"\") // Remove special characters\n    .replace(/[\\s_-]+/g, \"-\") // Replace spaces and underscores with hyphens\n    .replace(/^-+|-+$/g, \"\"); // Remove leading/trailing hyphens\n}\n\n/**\n * Generate a unique slug by appending a number if needed\n */\nexport function generateUniqueSlug(\n  name: string,\n  existingSlugs: string[]\n): string {\n  const baseSlug = generateSlug(name);\n\n  if (!existingSlugs.includes(baseSlug)) {\n    return baseSlug;\n  }\n\n  let counter = 1;\n  let uniqueSlug = `${baseSlug}-${counter}`;\n\n  while (existingSlugs.includes(uniqueSlug)) {\n    counter++;\n    uniqueSlug = `${baseSlug}-${counter}`;\n  }\n\n  return uniqueSlug;\n}\n","import { Hono } from \"hono\";\nimport { zValidator } from \"@hono/zod-validator\";\nimport {\n  createWorkspaceSchema,\n  updateWorkspaceSchema,\n  createProjectSchema,\n} from \"@nottto/shared\";\nimport { authMiddleware } from \"../middleware/auth\";\nimport * as workspaceService from \"../services/workspaces\";\nimport * as projectService from \"../services/projects\";\n\nexport const workspaceRoutes = new Hono();\n\n// All workspace routes require authentication\nworkspaceRoutes.use(\"*\", authMiddleware);\n\n// GET /workspaces - List user's workspaces\nworkspaceRoutes.get(\"/\", async (c) => {\n  const userId = c.get(\"userId\");\n  const workspaces = await workspaceService.list(userId);\n  return c.json({ workspaces });\n});\n\n// POST /workspaces - Create workspace\nworkspaceRoutes.post(\n  \"/\",\n  zValidator(\"json\", createWorkspaceSchema),\n  async (c) => {\n    const userId = c.get(\"userId\");\n    const data = c.req.valid(\"json\");\n    const workspace = await workspaceService.create(userId, data);\n    return c.json({ workspace }, 201);\n  }\n);\n\n// GET /workspaces/:id - Get workspace details\nworkspaceRoutes.get(\"/:id\", async (c) => {\n  const userId = c.get(\"userId\");\n  const workspaceId = c.req.param(\"id\");\n  const workspace = await workspaceService.get(workspaceId, userId);\n  return c.json({ workspace });\n});\n\n// PATCH /workspaces/:id - Update workspace\nworkspaceRoutes.patch(\n  \"/:id\",\n  zValidator(\"json\", updateWorkspaceSchema),\n  async (c) => {\n    const userId = c.get(\"userId\");\n    const workspaceId = c.req.param(\"id\");\n    const data = c.req.valid(\"json\");\n    const workspace = await workspaceService.update(workspaceId, userId, data);\n    return c.json({ workspace });\n  }\n);\n\n// DELETE /workspaces/:id - Delete workspace\nworkspaceRoutes.delete(\"/:id\", async (c) => {\n  const userId = c.get(\"userId\");\n  const workspaceId = c.req.param(\"id\");\n  await workspaceService.remove(workspaceId, userId);\n  return c.body(null, 204);\n});\n\n// GET /workspaces/:workspaceId/projects - List projects in workspace\nworkspaceRoutes.get(\"/:workspaceId/projects\", async (c) => {\n  const userId = c.get(\"userId\");\n  const workspaceId = c.req.param(\"workspaceId\");\n  const projects = await projectService.list(workspaceId, userId);\n  return c.json({ projects });\n});\n\n// POST /workspaces/:workspaceId/projects - Create project in workspace\nworkspaceRoutes.post(\n  \"/:workspaceId/projects\",\n  zValidator(\"json\", createProjectSchema),\n  async (c) => {\n    const userId = c.get(\"userId\");\n    const workspaceId = c.req.param(\"workspaceId\");\n    const data = c.req.valid(\"json\");\n    const project = await projectService.create(workspaceId, userId, data);\n    return c.json({ project }, 201);\n  }\n);\n","import { eq, or, and } from \"drizzle-orm\";\nimport { HTTPException } from \"hono/http-exception\";\nimport { db } from \"../db\";\nimport {\n  workspaces,\n  workspaceMembers,\n  projects,\n  annotations,\n} from \"@nottto/shared/db\";\nimport { generateSlug, generateUniqueSlug } from \"../utils/slug\";\nimport type {\n  Workspace,\n  CreateWorkspaceInput,\n  UpdateWorkspaceInput,\n} from \"@nottto/shared\";\n\nexport async function list(userId: string): Promise<Workspace[]> {\n  // Get workspaces where user is owner or member\n  const ownedWorkspaces = await db\n    .select()\n    .from(workspaces)\n    .where(eq(workspaces.ownerId, userId));\n\n  const memberWorkspaces = await db\n    .select({\n      id: workspaces.id,\n      name: workspaces.name,\n      slug: workspaces.slug,\n      ownerId: workspaces.ownerId,\n      createdAt: workspaces.createdAt,\n      updatedAt: workspaces.updatedAt,\n    })\n    .from(workspaceMembers)\n    .innerJoin(workspaces, eq(workspaceMembers.workspaceId, workspaces.id))\n    .where(eq(workspaceMembers.userId, userId));\n\n  // Combine and deduplicate\n  const allWorkspaces = [...ownedWorkspaces];\n  for (const ws of memberWorkspaces) {\n    if (!allWorkspaces.find((w) => w.id === ws.id)) {\n      allWorkspaces.push(ws);\n    }\n  }\n\n  return allWorkspaces.map((ws) => ({\n    id: ws.id,\n    name: ws.name,\n    slug: ws.slug,\n    ownerId: ws.ownerId,\n    createdAt: ws.createdAt,\n    updatedAt: ws.updatedAt,\n  }));\n}\n\nexport async function create(\n  userId: string,\n  data: CreateWorkspaceInput\n): Promise<Workspace> {\n  // Get existing slugs to ensure uniqueness\n  const existingWorkspaces = await db\n    .select({ slug: workspaces.slug })\n    .from(workspaces);\n  const existingSlugs = existingWorkspaces.map((w) => w.slug);\n\n  const slug = generateUniqueSlug(data.name, existingSlugs);\n\n  const [newWorkspace] = await db\n    .insert(workspaces)\n    .values({\n      name: data.name,\n      slug,\n      ownerId: userId,\n    })\n    .returning();\n\n  // Add user as owner member\n  await db.insert(workspaceMembers).values({\n    workspaceId: newWorkspace.id,\n    userId,\n    role: \"owner\",\n  });\n\n  return {\n    id: newWorkspace.id,\n    name: newWorkspace.name,\n    slug: newWorkspace.slug,\n    ownerId: newWorkspace.ownerId,\n    createdAt: newWorkspace.createdAt,\n    updatedAt: newWorkspace.updatedAt,\n  };\n}\n\nexport async function get(\n  workspaceId: string,\n  userId: string\n): Promise<Workspace> {\n  const [workspace] = await db\n    .select()\n    .from(workspaces)\n    .where(eq(workspaces.id, workspaceId))\n    .limit(1);\n\n  if (!workspace) {\n    throw new HTTPException(404, { message: \"Workspace not found\" });\n  }\n\n  // Check if user has access\n  const hasAccess = await checkAccess(workspaceId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, {\n      message: \"Access denied to this workspace\",\n    });\n  }\n\n  return {\n    id: workspace.id,\n    name: workspace.name,\n    slug: workspace.slug,\n    ownerId: workspace.ownerId,\n    createdAt: workspace.createdAt,\n    updatedAt: workspace.updatedAt,\n  };\n}\n\nexport async function update(\n  workspaceId: string,\n  userId: string,\n  data: UpdateWorkspaceInput\n): Promise<Workspace> {\n  const [workspace] = await db\n    .select()\n    .from(workspaces)\n    .where(eq(workspaces.id, workspaceId))\n    .limit(1);\n\n  if (!workspace) {\n    throw new HTTPException(404, { message: \"Workspace not found\" });\n  }\n\n  // Only owner can update\n  if (workspace.ownerId !== userId) {\n    throw new HTTPException(403, {\n      message: \"Only the owner can update this workspace\",\n    });\n  }\n\n  // Check slug uniqueness if updating slug\n  if (data.slug && data.slug !== workspace.slug) {\n    const [existing] = await db\n      .select()\n      .from(workspaces)\n      .where(eq(workspaces.slug, data.slug))\n      .limit(1);\n\n    if (existing) {\n      throw new HTTPException(409, { message: \"Slug already in use\" });\n    }\n  }\n\n  const [updated] = await db\n    .update(workspaces)\n    .set({\n      ...data,\n      updatedAt: new Date(),\n    })\n    .where(eq(workspaces.id, workspaceId))\n    .returning();\n\n  return {\n    id: updated.id,\n    name: updated.name,\n    slug: updated.slug,\n    ownerId: updated.ownerId,\n    createdAt: updated.createdAt,\n    updatedAt: updated.updatedAt,\n  };\n}\n\nexport async function remove(\n  workspaceId: string,\n  userId: string\n): Promise<void> {\n  const [workspace] = await db\n    .select()\n    .from(workspaces)\n    .where(eq(workspaces.id, workspaceId))\n    .limit(1);\n\n  if (!workspace) {\n    throw new HTTPException(404, { message: \"Workspace not found\" });\n  }\n\n  // Only owner can delete\n  if (workspace.ownerId !== userId) {\n    throw new HTTPException(403, {\n      message: \"Only the owner can delete this workspace\",\n    });\n  }\n\n  // Cascade delete is handled by database constraints\n  await db.delete(workspaces).where(eq(workspaces.id, workspaceId));\n}\n\n// Helper function to check if user has access to workspace\nexport async function checkAccess(\n  workspaceId: string,\n  userId: string\n): Promise<boolean> {\n  // Check if owner\n  const [workspace] = await db\n    .select()\n    .from(workspaces)\n    .where(and(eq(workspaces.id, workspaceId), eq(workspaces.ownerId, userId)))\n    .limit(1);\n\n  if (workspace) {\n    return true;\n  }\n\n  // Check if member\n  const [member] = await db\n    .select()\n    .from(workspaceMembers)\n    .where(\n      and(\n        eq(workspaceMembers.workspaceId, workspaceId),\n        eq(workspaceMembers.userId, userId)\n      )\n    )\n    .limit(1);\n\n  return !!member;\n}\n","import { eq, and } from \"drizzle-orm\";\nimport { HTTPException } from \"hono/http-exception\";\nimport { db } from \"../db\";\nimport { projects, workspaces } from \"@nottto/shared/db\";\nimport { checkAccess as checkWorkspaceAccess } from \"./workspaces\";\nimport { generateSlug, generateUniqueSlug } from \"../utils/slug\";\nimport type {\n  Project,\n  CreateProjectInput,\n  UpdateProjectInput,\n} from \"@nottto/shared\";\n\nexport async function list(\n  workspaceId: string,\n  userId: string\n): Promise<Project[]> {\n  // Check workspace access\n  const hasAccess = await checkWorkspaceAccess(workspaceId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, {\n      message: \"Access denied to this workspace\",\n    });\n  }\n\n  const projectList = await db\n    .select()\n    .from(projects)\n    .where(eq(projects.workspaceId, workspaceId));\n\n  return projectList.map((p) => ({\n    id: p.id,\n    workspaceId: p.workspaceId,\n    name: p.name,\n    slug: p.slug,\n    description: p.description,\n    createdAt: p.createdAt,\n    updatedAt: p.updatedAt,\n  }));\n}\n\nexport async function create(\n  workspaceId: string,\n  userId: string,\n  data: CreateProjectInput\n): Promise<Project> {\n  // Check workspace access\n  const hasAccess = await checkWorkspaceAccess(workspaceId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, {\n      message: \"Access denied to this workspace\",\n    });\n  }\n\n  // Get existing slugs in this workspace\n  const existingProjects = await db\n    .select({ slug: projects.slug })\n    .from(projects)\n    .where(eq(projects.workspaceId, workspaceId));\n\n  const existingSlugs = existingProjects.map((p) => p.slug);\n  const slug = generateUniqueSlug(data.name, existingSlugs);\n\n  const [newProject] = await db\n    .insert(projects)\n    .values({\n      workspaceId,\n      name: data.name,\n      slug,\n      description: data.description || null,\n    })\n    .returning();\n\n  return {\n    id: newProject.id,\n    workspaceId: newProject.workspaceId,\n    name: newProject.name,\n    slug: newProject.slug,\n    description: newProject.description,\n    createdAt: newProject.createdAt,\n    updatedAt: newProject.updatedAt,\n  };\n}\n\nexport async function get(projectId: string, userId: string): Promise<Project> {\n  const [project] = await db\n    .select()\n    .from(projects)\n    .where(eq(projects.id, projectId))\n    .limit(1);\n\n  if (!project) {\n    throw new HTTPException(404, { message: \"Project not found\" });\n  }\n\n  // Check workspace access\n  const hasAccess = await checkWorkspaceAccess(project.workspaceId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, { message: \"Access denied to this project\" });\n  }\n\n  return {\n    id: project.id,\n    workspaceId: project.workspaceId,\n    name: project.name,\n    slug: project.slug,\n    description: project.description,\n    createdAt: project.createdAt,\n    updatedAt: project.updatedAt,\n  };\n}\n\nexport async function update(\n  projectId: string,\n  userId: string,\n  data: UpdateProjectInput\n): Promise<Project> {\n  const [project] = await db\n    .select()\n    .from(projects)\n    .where(eq(projects.id, projectId))\n    .limit(1);\n\n  if (!project) {\n    throw new HTTPException(404, { message: \"Project not found\" });\n  }\n\n  // Check workspace access\n  const hasAccess = await checkWorkspaceAccess(project.workspaceId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, { message: \"Access denied to this project\" });\n  }\n\n  // Check slug uniqueness if updating slug\n  if (data.slug && data.slug !== project.slug) {\n    const [existing] = await db\n      .select()\n      .from(projects)\n      .where(\n        and(\n          eq(projects.workspaceId, project.workspaceId),\n          eq(projects.slug, data.slug)\n        )\n      )\n      .limit(1);\n\n    if (existing) {\n      throw new HTTPException(409, {\n        message: \"Slug already in use in this workspace\",\n      });\n    }\n  }\n\n  const [updated] = await db\n    .update(projects)\n    .set({\n      ...data,\n      updatedAt: new Date(),\n    })\n    .where(eq(projects.id, projectId))\n    .returning();\n\n  return {\n    id: updated.id,\n    workspaceId: updated.workspaceId,\n    name: updated.name,\n    slug: updated.slug,\n    description: updated.description,\n    createdAt: updated.createdAt,\n    updatedAt: updated.updatedAt,\n  };\n}\n\nexport async function remove(projectId: string, userId: string): Promise<void> {\n  const [project] = await db\n    .select()\n    .from(projects)\n    .where(eq(projects.id, projectId))\n    .limit(1);\n\n  if (!project) {\n    throw new HTTPException(404, { message: \"Project not found\" });\n  }\n\n  // Check workspace access\n  const hasAccess = await checkWorkspaceAccess(project.workspaceId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, { message: \"Access denied to this project\" });\n  }\n\n  // Cascade delete is handled by database constraints\n  await db.delete(projects).where(eq(projects.id, projectId));\n}\n\n// Helper to check if user has access to a project\nexport async function checkProjectAccess(\n  projectId: string,\n  userId: string\n): Promise<boolean> {\n  const [project] = await db\n    .select()\n    .from(projects)\n    .where(eq(projects.id, projectId))\n    .limit(1);\n\n  if (!project) {\n    return false;\n  }\n\n  return checkWorkspaceAccess(project.workspaceId, userId);\n}\n","import { Hono } from \"hono\";\nimport { zValidator } from \"@hono/zod-validator\";\nimport { updateProjectSchema, createAnnotationSchema } from \"@nottto/shared\";\nimport { authMiddleware } from \"../middleware/auth\";\nimport * as projectService from \"../services/projects\";\nimport * as annotationService from \"../services/annotations\";\n\nexport const projectRoutes = new Hono();\n\n// All project routes require authentication\nprojectRoutes.use(\"*\", authMiddleware);\n\n// GET /projects/:id - Get project details\nprojectRoutes.get(\"/:id\", async (c) => {\n  const userId = c.get(\"userId\");\n  const projectId = c.req.param(\"id\");\n  const project = await projectService.get(projectId, userId);\n  return c.json({ project });\n});\n\n// PATCH /projects/:id - Update project\nprojectRoutes.patch(\n  \"/:id\",\n  zValidator(\"json\", updateProjectSchema),\n  async (c) => {\n    const userId = c.get(\"userId\");\n    const projectId = c.req.param(\"id\");\n    const data = c.req.valid(\"json\");\n    const project = await projectService.update(projectId, userId, data);\n    return c.json({ project });\n  }\n);\n\n// DELETE /projects/:id - Delete project\nprojectRoutes.delete(\"/:id\", async (c) => {\n  const userId = c.get(\"userId\");\n  const projectId = c.req.param(\"id\");\n  await projectService.remove(projectId, userId);\n  return c.body(null, 204);\n});\n\n// GET /projects/:projectId/annotations - List annotations in project\nprojectRoutes.get(\"/:projectId/annotations\", async (c) => {\n  const userId = c.get(\"userId\");\n  const projectId = c.req.param(\"projectId\");\n  const annotations = await annotationService.list(projectId, userId);\n  return c.json({ annotations });\n});\n\n// POST /projects/:projectId/annotations - Create annotation in project\nprojectRoutes.post(\n  \"/:projectId/annotations\",\n  zValidator(\"json\", createAnnotationSchema),\n  async (c) => {\n    const userId = c.get(\"userId\");\n    const projectId = c.req.param(\"projectId\");\n    const data = c.req.valid(\"json\");\n    const annotation = await annotationService.create(projectId, userId, data);\n    return c.json({ annotation }, 201);\n  }\n);\n","import { eq, and } from \"drizzle-orm\";\nimport { HTTPException } from \"hono/http-exception\";\nimport { db } from \"../db\";\nimport { annotations, projects } from \"@nottto/shared/db\";\nimport { checkProjectAccess } from \"./projects\";\nimport type {\n  Annotation,\n  CreateAnnotationInput,\n  UpdateAnnotationInput,\n} from \"@nottto/shared\";\n\nexport async function list(\n  projectId: string,\n  userId: string\n): Promise<Annotation[]> {\n  // Check project access\n  const hasAccess = await checkProjectAccess(projectId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, { message: \"Access denied to this project\" });\n  }\n\n  const annotationList = await db\n    .select()\n    .from(annotations)\n    .where(eq(annotations.projectId, projectId));\n\n  return annotationList.map((a) => ({\n    id: a.id,\n    projectId: a.projectId,\n    userId: a.userId,\n    title: a.title,\n    description: a.description,\n    type: a.type as Annotation[\"type\"],\n    priority: a.priority as Annotation[\"priority\"],\n    pageUrl: a.pageUrl,\n    pageTitle: a.pageTitle,\n    screenshotOriginal: a.screenshotOriginal,\n    screenshotAnnotated: a.screenshotAnnotated,\n    canvasData: a.canvasData,\n    createdAt: a.createdAt,\n    updatedAt: a.updatedAt,\n  }));\n}\n\nexport async function create(\n  projectId: string,\n  userId: string,\n  data: CreateAnnotationInput\n): Promise<Annotation> {\n  // Check project access\n  const hasAccess = await checkProjectAccess(projectId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, { message: \"Access denied to this project\" });\n  }\n\n  const [newAnnotation] = await db\n    .insert(annotations)\n    .values({\n      projectId,\n      userId,\n      title: data.title,\n      description: data.description || null,\n      type: data.type || null,\n      priority: data.priority || null,\n      pageUrl: data.pageUrl || null,\n      pageTitle: data.pageTitle || null,\n      screenshotOriginal: data.screenshotOriginal || null,\n      screenshotAnnotated: data.screenshotAnnotated || null,\n      canvasData: data.canvasData || null,\n    })\n    .returning();\n\n  return {\n    id: newAnnotation.id,\n    projectId: newAnnotation.projectId,\n    userId: newAnnotation.userId,\n    title: newAnnotation.title,\n    description: newAnnotation.description,\n    type: newAnnotation.type as Annotation[\"type\"],\n    priority: newAnnotation.priority as Annotation[\"priority\"],\n    pageUrl: newAnnotation.pageUrl,\n    pageTitle: newAnnotation.pageTitle,\n    screenshotOriginal: newAnnotation.screenshotOriginal,\n    screenshotAnnotated: newAnnotation.screenshotAnnotated,\n    canvasData: newAnnotation.canvasData,\n    createdAt: newAnnotation.createdAt,\n    updatedAt: newAnnotation.updatedAt,\n  };\n}\n\nexport async function get(\n  annotationId: string,\n  userId: string\n): Promise<Annotation> {\n  const [annotation] = await db\n    .select()\n    .from(annotations)\n    .where(eq(annotations.id, annotationId))\n    .limit(1);\n\n  if (!annotation) {\n    throw new HTTPException(404, { message: \"Annotation not found\" });\n  }\n\n  // Check project access\n  const hasAccess = await checkProjectAccess(annotation.projectId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, {\n      message: \"Access denied to this annotation\",\n    });\n  }\n\n  return {\n    id: annotation.id,\n    projectId: annotation.projectId,\n    userId: annotation.userId,\n    title: annotation.title,\n    description: annotation.description,\n    type: annotation.type as Annotation[\"type\"],\n    priority: annotation.priority as Annotation[\"priority\"],\n    pageUrl: annotation.pageUrl,\n    pageTitle: annotation.pageTitle,\n    screenshotOriginal: annotation.screenshotOriginal,\n    screenshotAnnotated: annotation.screenshotAnnotated,\n    canvasData: annotation.canvasData,\n    createdAt: annotation.createdAt,\n    updatedAt: annotation.updatedAt,\n  };\n}\n\nexport async function update(\n  annotationId: string,\n  userId: string,\n  data: UpdateAnnotationInput\n): Promise<Annotation> {\n  const [annotation] = await db\n    .select()\n    .from(annotations)\n    .where(eq(annotations.id, annotationId))\n    .limit(1);\n\n  if (!annotation) {\n    throw new HTTPException(404, { message: \"Annotation not found\" });\n  }\n\n  // Check project access\n  const hasAccess = await checkProjectAccess(annotation.projectId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, {\n      message: \"Access denied to this annotation\",\n    });\n  }\n\n  // Only the creator can update (or anyone with project access for now)\n  // You could add stricter checks here if needed\n\n  const updateData: Record<string, unknown> = { updatedAt: new Date() };\n\n  if (data.title !== undefined) updateData.title = data.title;\n  if (data.description !== undefined) updateData.description = data.description;\n  if (data.type !== undefined) updateData.type = data.type;\n  if (data.priority !== undefined) updateData.priority = data.priority;\n  if (data.pageUrl !== undefined) updateData.pageUrl = data.pageUrl;\n  if (data.pageTitle !== undefined) updateData.pageTitle = data.pageTitle;\n  if (data.screenshotOriginal !== undefined)\n    updateData.screenshotOriginal = data.screenshotOriginal;\n  if (data.screenshotAnnotated !== undefined)\n    updateData.screenshotAnnotated = data.screenshotAnnotated;\n  if (data.canvasData !== undefined) updateData.canvasData = data.canvasData;\n\n  const [updated] = await db\n    .update(annotations)\n    .set(updateData)\n    .where(eq(annotations.id, annotationId))\n    .returning();\n\n  return {\n    id: updated.id,\n    projectId: updated.projectId,\n    userId: updated.userId,\n    title: updated.title,\n    description: updated.description,\n    type: updated.type as Annotation[\"type\"],\n    priority: updated.priority as Annotation[\"priority\"],\n    pageUrl: updated.pageUrl,\n    pageTitle: updated.pageTitle,\n    screenshotOriginal: updated.screenshotOriginal,\n    screenshotAnnotated: updated.screenshotAnnotated,\n    canvasData: updated.canvasData,\n    createdAt: updated.createdAt,\n    updatedAt: updated.updatedAt,\n  };\n}\n\nexport async function remove(\n  annotationId: string,\n  userId: string\n): Promise<void> {\n  const [annotation] = await db\n    .select()\n    .from(annotations)\n    .where(eq(annotations.id, annotationId))\n    .limit(1);\n\n  if (!annotation) {\n    throw new HTTPException(404, { message: \"Annotation not found\" });\n  }\n\n  // Check project access\n  const hasAccess = await checkProjectAccess(annotation.projectId, userId);\n  if (!hasAccess) {\n    throw new HTTPException(403, {\n      message: \"Access denied to this annotation\",\n    });\n  }\n\n  await db.delete(annotations).where(eq(annotations.id, annotationId));\n}\n","import { Hono } from \"hono\";\nimport { zValidator } from \"@hono/zod-validator\";\nimport { updateAnnotationSchema } from \"@nottto/shared\";\nimport { authMiddleware } from \"../middleware/auth\";\nimport * as annotationService from \"../services/annotations\";\n\nexport const annotationRoutes = new Hono();\n\n// All annotation routes require authentication\nannotationRoutes.use(\"*\", authMiddleware);\n\n// GET /annotations/:id - Get annotation details\nannotationRoutes.get(\"/:id\", async (c) => {\n  const userId = c.get(\"userId\");\n  const annotationId = c.req.param(\"id\");\n  const annotation = await annotationService.get(annotationId, userId);\n  return c.json({ annotation });\n});\n\n// PATCH /annotations/:id - Update annotation\nannotationRoutes.patch(\n  \"/:id\",\n  zValidator(\"json\", updateAnnotationSchema),\n  async (c) => {\n    const userId = c.get(\"userId\");\n    const annotationId = c.req.param(\"id\");\n    const data = c.req.valid(\"json\");\n    const annotation = await annotationService.update(\n      annotationId,\n      userId,\n      data\n    );\n    return c.json({ annotation });\n  }\n);\n\n// DELETE /annotations/:id - Delete annotation\nannotationRoutes.delete(\"/:id\", async (c) => {\n  const userId = c.get(\"userId\");\n  const annotationId = c.req.param(\"id\");\n  await annotationService.remove(annotationId, userId);\n  return c.body(null, 204);\n});\n","import { Hono } from \"hono\";\nimport { HTTPException } from \"hono/http-exception\";\nimport { authMiddleware } from \"../middleware/auth\";\nimport * as uploadService from \"../services/upload\";\n\nexport const uploadRoutes = new Hono();\n\n// All upload routes require authentication\nuploadRoutes.use(\"*\", authMiddleware);\n\n// POST /upload/screenshot - Upload screenshot to Vercel Blob\nuploadRoutes.post(\"/screenshot\", async (c) => {\n  const userId = c.get(\"userId\");\n\n  const body = await c.req.parseBody();\n  const file = body[\"file\"];\n\n  if (!file || !(file instanceof File)) {\n    throw new HTTPException(400, { message: \"No file provided\" });\n  }\n\n  const result = await uploadService.uploadScreenshot(file, userId);\n  return c.json(result, 201);\n});\n","import { put } from \"@vercel/blob\";\nimport { HTTPException } from \"hono/http-exception\";\n\nconst MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB\nconst ALLOWED_TYPES = [\"image/png\", \"image/jpeg\", \"image/gif\", \"image/webp\"];\n\nexport async function uploadScreenshot(\n  file: File,\n  userId: string\n): Promise<{ url: string }> {\n  // Validate file size\n  if (file.size > MAX_FILE_SIZE) {\n    throw new HTTPException(413, { message: \"File size exceeds 10MB limit\" });\n  }\n\n  // Validate file type\n  if (!ALLOWED_TYPES.includes(file.type)) {\n    throw new HTTPException(400, {\n      message: \"Invalid file type. Only PNG, JPEG, GIF, and WebP are allowed\",\n    });\n  }\n\n  // Generate unique filename\n  const timestamp = Date.now();\n  const extension = file.name.split(\".\").pop() || \"png\";\n  const filename = `screenshots/${userId}/${timestamp}.${extension}`;\n\n  try {\n    const blob = await put(filename, file, {\n      access: \"public\",\n      addRandomSuffix: true,\n    });\n\n    return { url: blob.url };\n  } catch (error) {\n    console.error(\"Upload error:\", error);\n    throw new HTTPException(500, { message: \"Failed to upload file\" });\n  }\n}\n","import type { Context } from \"hono\";\nimport { HTTPException } from \"hono/http-exception\";\nimport { ZodError } from \"zod\";\n\ninterface ErrorResponse {\n  error: {\n    code: string;\n    message: string;\n    details?: Record<string, string[]>;\n  };\n}\n\nfunction getErrorCode(status: number): string {\n  const codes: Record<number, string> = {\n    400: \"BAD_REQUEST\",\n    401: \"UNAUTHORIZED\",\n    403: \"FORBIDDEN\",\n    404: \"NOT_FOUND\",\n    409: \"CONFLICT\",\n    413: \"PAYLOAD_TOO_LARGE\",\n    500: \"INTERNAL_ERROR\",\n  };\n  return codes[status] || \"UNKNOWN_ERROR\";\n}\n\nfunction formatZodErrors(error: ZodError): Record<string, string[]> {\n  const details: Record<string, string[]> = {};\n  for (const issue of error.issues) {\n    const path = issue.path.join(\".\");\n    if (!details[path]) {\n      details[path] = [];\n    }\n    details[path].push(issue.message);\n  }\n  return details;\n}\n\nexport function errorHandler(err: Error, c: Context): Response {\n  // Handle HTTP exceptions (thrown by our code)\n  if (err instanceof HTTPException) {\n    const response: ErrorResponse = {\n      error: {\n        code: getErrorCode(err.status),\n        message: err.message,\n      },\n    };\n    return c.json(response, err.status);\n  }\n\n  // Handle Zod validation errors\n  if (err instanceof ZodError) {\n    const response: ErrorResponse = {\n      error: {\n        code: \"VALIDATION_ERROR\",\n        message: \"Invalid input\",\n        details: formatZodErrors(err),\n      },\n    };\n    return c.json(response, 400);\n  }\n\n  // Log internal errors but don't expose details\n  console.error(\"Internal error:\", err);\n\n  const response: ErrorResponse = {\n    error: {\n      code: \"INTERNAL_ERROR\",\n      message: \"An unexpected error occurred\",\n    },\n  };\n  return c.json(response, 500);\n}\n"],"mappings":"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","names":["Hono","HTTPException","jwtVerify","jwtVerify","HTTPException","Hono","zValidator","eq","HTTPException","eq","HTTPException","eq","and","HTTPException","list","HTTPException","eq","create","get","update","and","remove","Hono","workspaces","zValidator","projects","list","create","Hono","zValidator","eq","HTTPException","list","HTTPException","eq","create","get","update","remove","Hono","get","zValidator","update","remove","annotations","list","create","Hono","zValidator","Hono","get","zValidator","update","remove","Hono","HTTPException","HTTPException","timestamp","Hono","HTTPException","HTTPException","response","Hono"]}